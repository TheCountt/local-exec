---
- name: Update ubuntu
  ansible.builtin.apt:
   update_cache: yes


# Install and Configure these softwares on CI server for Containerization in Pipeline
- name: install java 11 and other packages
  ansible.builtin.apt:
   name: "{{ item }}"
   state: present
   update_cache: yes
  loop: 
    - fontconfig
    - openjdk-11-jre
    - docker.io
    # - nodejs
    # - npm
    - docker-compose

- name: install jenkins apt repository key
  apt_key: 
   url: https://pkg.jenkins.io/debian/jenkins.io.key
   state: present

- name: ensure the repository is installed
  apt_repository: 
   repo: 'deb https://pkg.jenkins.io/debian binary/'
   state: present
  
- name: install jenkins
  ansible.builtin.apt: 
   name: jenkins
   state: present
   update_cache: yes
   force_apt_get: yes

- name: start and enable jenkins
  ansible.builtin.service:
   name: jenkins
   state: started
   enabled: true
   daemon_reload: yes
  notify: Restart jenkins server
