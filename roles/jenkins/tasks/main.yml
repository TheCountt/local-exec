---
- name: install jenkins on debian OS
  include_tasks: debian.yml
  when: ansible_os_family == 'Debian'

- name: install jenkins on redhat OS
  include_tasks: redhat.yml
  when: ansible_os_family == 'Redhat'

- name: install community module
  shell: >
   ansible-galaxy collection install community.postgresql
  args:
   creates: community.txt

# Install and Configure Docker on CI server for Containerization in Pipeline
- name: install docker
  ansible.builtin.apt:
   name: docker.io
   state: present
   update_cache: yes


- name: Create group "docker"
  ansible.builtin.group:
    name: docker
    state: present

- name: Add current user to group 'docker'
  ansible.builtin.user:
    name: $USER
    comment: Name of current user
    group: docker

- name: Start docker
  become: true
  ansible.builtin.systemd: 
    name: docker
    state: restarted
    enabled: yes
    daemon_reload: yes